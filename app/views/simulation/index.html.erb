<script>
	$( document ).ready(function() {
		$("#create").click(function() {
			
			var json = "{[{'stage_num' : 'stage1', 'stage_data' : [{ 'name1' : 'fieldname1', 'value1' : fieldvalue1 },{ 'name2' : 'fieldname2', 'value2' : fieldvalue2 } ]},{'stage_num' : 'stage2', 'stage_data' : [{ 'name3' : 'fieldname3', 'value3' : 'fieldvalue3' },{ 'name4' : 'fieldname4', 'value4' : 'fieldvalue4' }]}]}";
		
			$.ajax({
				url: "simulation.json", 
				type: "POST",
				data: {mockdata : { "workflow_id" : 1, "mockdata" : json }},
				success: function(sim_id) {
					$('#alert_text').html('Simulation ' + sim_id + ' successfully created!');
					$('#alert_status').show();
				}
			});
		});
		
		$(".delete").click(function() {
			
			var sim_id= $(this).parent('td').parent('tr').find('.sim_id').data('id');
			
			$.ajax({
				beforeSend: function(req) {
					req.setRequestHeader("Accept", "application/json");
				},
				url: "simulation/" + sim_id, 
				type: "DELETE",
				success: function(sim_id) {
					$('#alert_text').html('Simulation ' + sim_id + ' successfully deleted!');
					$('#alert_status').show();
				}
			});
		});
		
		$(".update").click(function() {
			
			var sim_id= $(this).parent('td').parent('tr').find('.sim_id').data('id');
			
			$.ajax({
				beforeSend: function(req) {
					req.setRequestHeader("Accept", "application/json");
				},
				url: "simulation/" + sim_id, 
				type: "PUT",
				data: {mockdata : { "workflow_id" : 2, "mockdata" : "updated_data" }},
				success: function(sim_id) {
					$('#alert_text').html('Simulation ' + sim_id + ' has been updated!');
					$('#alert_status').show();
				}
			});
		});
	});
</script>


			<h1>Simulation</h1>

			<div id="alert_status" class="alert alert-success alert-dismissable" style="display:none">
				<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
				<p id="alert_text">asfasf</p>
			</div>
			
			<button type="button" class="btn btn-info" id="create">Create Mock Data</button>

			<table class="table">
				<thead>
					  <tr>
						<th>Simulation ID</th>
						<th>Workflow ID</th>
						<th>Mock Data</th>
						<th></th>
						<th></th>
					  </tr>
				</thead>
				<tbody>
					<% @mockdata.each do |data| %>
						  <tr>
							<td class="sim_id" data-id=<%= data.id %>><%= data.id %></td>
							<td><%= data.workflow_id %></td>
							<td><%= data.mockdata %></td>
							<td>
								<button class="delete">Delete</button>
							</td>
							<td>
								<button class="update">Update</button>
							</td>
						  </tr>
					<% end %>
				</tbody>
			</table>
		